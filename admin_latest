file_manager = "manager.txt"
file_chef = "chef.txt"
file_admin = "admin.txt" #update own profile for admin
file_feedback = "feedback.txt"
def main_menu_admin():
    try:
        print("\n-------------- \nChoose option: \n-------------- \n1.Manage staff \n2.View sales report \n3.View feedback send by customer \n4.Update own profile")
        option = int(input("Please enter option:"))
        if 1 <= option <= 4:
            if option == 1:
                print("\nManage staff \n------------ \n1.Manager \n2.Chef")
                manage = int(input("Please enter option:"))
                try:
                    if manage == 1:
                        try:
                            print("\nManager \n--------- \n1.Add \n2.Edit \n3.Delete")
                            x = int(input("Please enter option:"))
                            if x == 1:
                                add_staff(file_manager)
                            elif x == 2:
                                edit_staff(file_manager)
                            elif x == 3:
                                delete_staff(file_manager)
                        except ValueError:
                            print("Invalid input. Please enter number 1 to 3")
                        main_menu_admin()
                    else:
                        try:
                            print("\nChef \n--------- \n1.Add \n2.Edit \n3.Delete")
                            y = int(input("Enter your option:"))
                            if y == 1:
                                add_staff(file_chef)
                            elif y == 2:
                                edit_staff(file_chef)
                            elif y == 3:
                                delete_staff(file_chef)
                        except ValueError:
                            print("Invalid input. Please enter number 1 to 3")
                        main_menu_admin()
                except ValueError:
                    print("Invalid input. Please enter number 1 to 3 ")
                main_menu_admin()
            elif option == 2:
                view_sales_admin()
            elif option == 3:
                feedback(file_feedback)
            elif option == 4:
                update_admin(file_admin)
        else:
            print("Invalid input. Please enter number 1 to 4")
    except ValueError:
        print("Invalid input. Please enter number 1 to 4")
    main_menu_admin()

def add_staff(fileworker):
    print("\nAdding staff \n------------")
    staffID = input("Enter staffID: ")
    username = input("Enter username: ")
    password = input("Enter password: ")
    role = input("Enter role: ")
    name = input("Enter name:")
    email = input("Enter your email:")
    phone = input("Enter your phone number:")
    gender = input("Enter your gender:")
    experience = input("Enter your years of experience:")

    with open(fileworker, "r") as f:
        lines = f.readlines()
        for line in lines:
            data = line.strip().split(",")
            if data[0] == staffID and data[1] == username and data[2] == password:
                print(f"{staffID}, {username} already exist.")
                main_menu_admin()
                return #ensure no further processing occurs


    with open(fileworker, "a") as f:
        f.write(f"{staffID},{username},{password},{role},{name},{email},{phone},{gender},{experience}\n") # write staffs' info to the file

    print(f"Hi, {username} with staffID:{staffID} added successfully.")
    main_menu_admin()

def edit_staff(fileworker):
    staffID = input(f"Enter staffID of the staff that you want to edit: ")
    username = input("Enter username of the staff that you want to edit: ")
    try:
        with open(fileworker, "r") as f:
            worker_lines = f.readlines() #read each line in the file into the lines list
    except FileNotFoundError:
        print(f"No staff records found")
        return

    new_worker_lines = []
    staff_found = False
    updated_worker = False
    for line in worker_lines:
        data = line.strip().split(",") #split the line with "," and spacing
        if data[0] == staffID and data[1] == username: #data[0] represent the first data in the list (staffID) andn data[1] is username
            staff_found = True
            print("\n--------------------------------")
            print(f"StaffID:{data[0]}")
            print(f"Username:{data[1]}")
            print(f"Password:{data[2]}")
            print(f"Role:{data[3]}")
            print(f"Name:{data[4]}")
            print(f"Email:{data[5]}")
            print(f"Phone number:{data[6]}")
            print(f"Gender:{data[7]}")
            print(f"Years of experience:{data[8]}")
            print("-------------------------------- \n")
            while True:
                try:
                    print(f"Editing details for {username} with staffID:{staffID}")
                    print(f"1.StaffID \n2.Username \n3.Password \n4.Role \n5.Name \n6.Gender \n7.Email \n8.Phone number \n9.Years of experience \n10.Save and exit")
                    choice = int(input(f"Enter your choice on which you wish to edit: "))
                    if choice == 1:
                        data[0] = input(f"Enter new staffID: ")
                    elif choice == 2:
                        data[1] = input(f"Enter new username: ")
                    elif choice == 3:
                        data[2] = input(f"Enter new password: ")
                    elif choice == 4:
                        data[3] = input("Enter new role:")
                    elif choice == 5:
                        data[4] = input("Enter your new name:")
                    elif choice == 6:
                        data[5] = input("Enter your new gender:")
                    elif choice == 7:
                        data[6] = input("Enter your new email:")
                    elif choice == 8:
                        data[7] = input("Enter your new phone number:")
                    elif choice == 9:
                        data[8] = input("Enter your new years of experience:")
                    elif choice == 10:
                        print(f"{data[1]}'s data successfully updated. Exiting edit mode.")
                        updated_worker = True
                        break
                    else:
                        print("Invalid input, please enter number 1 to 5")
                except ValueError:
                    print("Invalid input. Please enter number.")
            if updated_worker:
                #write the new data into the fileworker
                new_worker_lines.append(f"{data[0]},{data[1]},{data[2]},{data[3]},{data[4]},{data[5]},{data[6]},{data[7]},{data[8]}\n")
        else:
            new_worker_lines.append(line) #write back unmodified lines

    if not staff_found:
        print(f"No staff {username} with staffID {staffID} found. Please try again.")
        return

    with open(fileworker, "w") as f:
        f.writelines(new_worker_lines) #write the new updated lines into fileworker

    main_menu_admin()

def delete_staff(fileworker):
    while True:
        try:
            with open(fileworker, "r") as f:
                lines = f.readlines()
                staffID = input("Enter staffID that you want to delete:").capitalize().strip()
                username = input("Enter username that you want to delete:").capitalize().strip()
                found = False
                with open(fileworker, "w") as f:
                    for line in lines:
                        if staffID and username not in line:
                            f.write(line)
                            break
                        else:
                            found = True
                if found:
                    print(f"{username} successfully deleted from the record.")
                else:
                    print('not found')
                    another = input("do you want to enter again (Y/N:)").capitalize().strip()
                    if another != 'y':
                        print('')
                        main_menu_admin()
                        break
        except:
            print("Please try again.")
            main_menu_admin()

def view_sales_admin():
    print("")

def feedback(file_feedback):
    with open(file_feedback, "r")as f:
        lines = f.readlines()

        for line in lines:
            data = line.strip().split(',')
            customerID = data[0]
            rate = data[1]
            review = data[2]
            print(f"Feedback sent by customer \n--------------------- \nCustomer:{customerID} gives rating of {rate} with review:{review}")

def update_admin(file_admin):
    try:
        with open(file_admin, "r") as f:
            admin_lines = f.readlines()
    except FileNotFoundError:
        print("No admin found:")
        return

    data = admin_lines[0].strip().split(",") #first line
    print("\n--------------------------------")
    print(f"Username:{data[0]}")
    print(f"Password:{data[1]}")
    print(f"Name:{data[2]}")
    print(f"Email:{data[3]}")
    print(f"Phone number:{data[4]}")
    print(f"Gender:{data[5]}")
    print(f"Years of experience:{data[6]}")
    print("-------------------------------- \n")
    while True:
        print("=====Update own profile===== \n1.Username \n2.Password \n3.Name \n4.Email \n5.Phone number \n6.Gender \n7.Years of experience \n8.Exit")
        try:
            pick = int(input("Enter your option:"))
            if pick == 1:
                data[0] = input("Enter your new username:")
            elif pick == 2:
                data[1] = input("Enter your new password:")
            elif pick == 3:
                data[2] = input("Enter your new name:")
            elif pick == 4:
                data[3] = input("Enter your new email:")
            elif pick == 5:
                data[4] = input("Enter your new phone number:")
            elif pick == 6:
                data[5] = input("Enter your new gender:")
            elif pick == 7:
                data[6] = input("Enter your new years of experience:")
            elif pick == 8: #ensure this code is being executed only when it is pick
                print("Exiting update own profile.")
                with open(file_admin,"w") as f:
                    f.write(",".join(data)+"\n")
                print("Profile updated successfully.")
                break
        except ValueError:
            print("Invalid input. Please enter number 1 to 8.")



main_menu_admin()

